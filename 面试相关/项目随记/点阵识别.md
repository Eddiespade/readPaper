# 点阵字符分割项目 随记

**样本：**

​	以现场采集到的旺仔牛奶盒顶部的生产日期作为实验样本。

**难点：**

1. 通常在采集图像过程中图像区域容易受自然光及照明灯光影响，从而会导致每张图呈现的效果不一。
2. 同样，由于牛奶盒采用锡纸材料容易**受外力产生变形**，因此会导致喷印的生产日期弯曲，从而使同张图像上表现出**不均**匀的**光照**情况。
3. 而在进行喷印的过程中会产生多余的**外溅墨点**，这些因素都使得字符的分割识别变得困难，因此有效的点阵字符预处理方法是提高点阵字符分割和识别率的基本要求。

### 1. 图像预处理方法

- 灰度化处理
- 直方图均衡化
- 滤波处理
- 阈值化处理

### 2. 字符的定位算法

- 边缘检测算法
- 投影直方图定位

### 2. 如何分割成单个点阵字符？

- 基于字符固定宽的分割算法
- 基于垂直投影分割算法
- 基于滴水算法的分割方法
- 基于滑动窗口的字符分割法

获取每行字符块：

- 利用**水平投影法**将点阵字符的二值化图像进行水平投影，统计每**行**的白色像素点个数，得到波峰波谷信息，然后依据点阵字符的高度范围先验定位出字符所在的区域

![image-20220323221408352](项目相关随记.assets/image-20220323221408352.png)

- 有变形情况，需要判定并拼接重组

  ![image-20220323221639663](项目相关随记.assets/image-20220323221639663.png)

  训练SVM网络，分割图片（将喷点的融合特征作为训练数据集，类别集中包含0和1，0表示背景，1表示目标）。以点阵字符中喷点的几何先验为特征，利用单个喷点的最大直径信息对点阵字符进行分割。

  ![image-20220323222357381](项目相关随记.assets/image-20220323222357381.png)

### 3. 如何对分割好的点阵字符进行分类？

首先搭建19层残差网络，其中后两层为全连接层，分别用于计算Center Loss函数与Softmax Loss函数，在网络训练完成后得到更新权重的网络，同时求取每类点阵字符的中心特征向量。接着计算测试集中单个点阵字符的特征向量，最后求取其与每类点阵字符中心特征向量的余弦相似度，用于判断点阵字符是否存在缺陷。

### 4. 为什么提出余弦相似度？作用是什么？

**问题：**对于存在**缺陷的点阵字符**而言，其特征**与合格点阵字符特征间具有较大的相似度**，会导致卷积神经网络无法准确地分出具有缺陷的点阵字符。

**余弦相似度算法**：采用残差块结构作为整个神经网络识别检测系统的主架构，**最后两层为全连接层**，第一个全连接层输出用于计算Island Loss，第二个全连接层用于计算Softmax Loss，Island Loss**在关注类别的类内距离的同时，优化类间距离**，使得每个类别拥有更大的margin,从而迫使网络能够学习到更具判别性的特征。Softmax Loss用于确定样本所属类别并**扩大类间差距**。两者相结合以调整神经网络框架的训练权重；然后获取各类别的平均特征向量；最后输入样本测试集，经过更新权重的模型获取样本最后一层的输出特征向量，求该输出特征向量与对应类别平均特征向量的余弦相似度，以确定测试的点阵字符图像是否存在缺陷。

![img](项目相关随记.assets/20190507142551629.png)